<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>TMDB Post Generator</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
<style>
body { background:#f5f6fa; font-family:'Poppins',sans-serif; }
.card { border-radius:20px; box-shadow:0 2px 10px rgba(0,0,0,0.1); }
textarea { resize:none; }
.output-box { background:#1e1e1e; color:#00ff99; padding:15px; border-radius:10px; height:300px; overflow:auto; }
.preview-box { background:#fff; padding:20px; border-radius:15px; box-shadow:0 0 10px rgba(0,0,0,0.1); margin-top:15px; }
.download-pair { display:flex; gap:10px; margin-bottom:10px; }
button { border-radius:10px !important; }
</style>
</head>
<body class="p-4">

<div class="container">
  <h2 class="text-center mb-4">üé¨ TMDB Post Generator</h2>

  <div class="card p-4">
    <div class="mb-3">
      <label class="form-label">TMDB ID / Movie or Series Name</label>
      <input type="text" id="tmdbInput" class="form-control" placeholder="e.g. 550 or Breaking Bad">
    </div>

    <button class="btn btn-primary mb-4" onclick="fetchTMDB()">Fetch from TMDB</button>

    <div id="fields">
      <div class="row">
        <div class="col-md-4">
          <label class="form-label">Type</label>
          <input type="text" id="type" class="form-control" placeholder="movie or series">
        </div>
        <div class="col-md-4">
          <label class="form-label">Title</label>
          <input type="text" id="title" class="form-control">
        </div>
        <div class="col-md-4">
          <label class="form-label">Original Title</label>
          <input type="text" id="original_title" class="form-control">
        </div>
      </div>

      <label class="form-label mt-3">Overview</label>
      <textarea id="overview" class="form-control" rows="3"></textarea>

      <div class="row mt-3">
        <div class="col-md-6">
          <label class="form-label">Tagline</label>
          <input type="text" id="tagline" class="form-control">
        </div>
        <div class="col-md-6">
          <label class="form-label">Release / First Air Date</label>
          <input type="text" id="release_date" class="form-control">
        </div>
      </div>

      <div class="row mt-3">
        <div class="col-md-6">
          <label class="form-label">Runtime / Episode Runtime</label>
          <input type="text" id="runtime" class="form-control">
        </div>
        <div class="col-md-6">
          <label class="form-label">Language(s)</label>
          <input type="text" id="languages" class="form-control">
        </div>
      </div>

      <div class="row mt-3">
        <div class="col-md-6">
          <label class="form-label">Genres</label>
          <input type="text" id="genres" class="form-control">
        </div>
        <div class="col-md-6">
          <label class="form-label">Rating (Vote Average)</label>
          <input type="text" id="rating" class="form-control">
        </div>
      </div>

      <div class="row mt-3">
        <div class="col-md-6">
          <label class="form-label">Director(s)</label>
          <input type="text" id="director" class="form-control">
        </div>
        <div class="col-md-6">
          <label class="form-label">Writer(s)</label>
          <input type="text" id="writer" class="form-control">
        </div>
      </div>

      <label class="form-label mt-3">Cast</label>
      <input type="text" id="cast" class="form-control">

      <label class="form-label mt-3">Poster Image URL</label>
      <input type="text" id="poster" class="form-control">

      <label class="form-label mt-3">Backdrop Image URL</label>
      <input type="text" id="backdrop" class="form-control">

      <label class="form-label mt-3">Trailer (YouTube URL)</label>
      <input type="text" id="trailer" class="form-control">
    </div>

    <h5 class="mt-4">Download Links</h5>
    <div id="download-links"></div>
    <button class="btn btn-secondary mt-2" onclick="addDownload()">+ Add More</button>

    <button class="btn btn-success w-100 mt-4" onclick="generateHTML()">Generate HTML</button>
  </div>

  <h4 class="mt-4">Generated HTML Code</h4>
  <div class="output-box" id="output"></div>

  <h4 class="mt-4">üîç Blogger Post Preview</h4>
  <div id="preview" class="preview-box"></div>

  <div class="mt-3 d-flex gap-2">
    <button class="btn btn-outline-primary flex-fill" onclick="copyHTML()">Copy HTML</button>
    <button class="btn btn-warning flex-fill" onclick="postToBlogger()">Post to Blogger (Gmail)</button>
  </div>
</div>

<script>
const apiKey = "55b11132b5aef36e8376418dcce756f2"; 
const bloggerEmail = "sarvesh.asatkarr.titu@blogger.com"; 

async function fetchTMDB() {
  const id=document.getElementById("tmdbInput").value.trim();
  if(!id)return alert("Enter TMDB ID or name");
  let data=null,type="movie";
  try{
    if(isNaN(id)){
      const sM=await fetch(`https://api.themoviedb.org/3/search/movie?api_key=${apiKey}&query=${encodeURIComponent(id)}`).then(r=>r.json());
      const sT=await fetch(`https://api.themoviedb.org/3/search/tv?api_key=${apiKey}&query=${encodeURIComponent(id)}`).then(r=>r.json());
      if(sM.results?.length){data=await fetch(`https://api.themoviedb.org/3/movie/${sM.results[0].id}?api_key=${apiKey}&append_to_response=credits,videos`).then(r=>r.json());type="movie";}
      else if(sT.results?.length){data=await fetch(`https://api.themoviedb.org/3/tv/${sT.results[0].id}?api_key=${apiKey}&append_to_response=credits,videos`).then(r=>r.json());type="series";}
    }else{
      const mR=await fetch(`https://api.themoviedb.org/3/movie/${id}?api_key=${apiKey}&append_to_response=credits,videos`);
      if(mR.ok){data=await mR.json();type="movie";}else{
        const tR=await fetch(`https://api.themoviedb.org/3/tv/${id}?api_key=${apiKey}&append_to_response=credits,videos`);
        if(tR.ok){data=await tR.json();type="series";}
      }
    }
    if(!data)return alert("Not found!");

    document.getElementById("type").value=type;
    document.getElementById("title").value=data.title||data.name||"";
    document.getElementById("original_title").value=data.original_title||data.original_name||"";
    document.getElementById("overview").value=data.overview||"";
    document.getElementById("tagline").value=data.tagline||"";
    document.getElementById("release_date").value=data.release_date||data.first_air_date||"";
    document.getElementById("runtime").value=data.runtime||(data.episode_run_time?data.episode_run_time[0]:"")||"";
    document.getElementById("languages").value=data.spoken_languages?.map(l=>l.english_name).join(", ")||"";
    document.getElementById("genres").value=data.genres?.map(g=>g.name).join(", ")||"";
    document.getElementById("rating").value=data.vote_average||"";
    document.getElementById("cast").value=data.credits?.cast?.slice(0,5).map(c=>c.name).join(", ")||"";
    const d=data.credits?.crew?.find(c=>c.job==="Director");
    const w=data.credits?.crew?.find(c=>c.job==="Writer"||c.job==="Screenplay");
    document.getElementById("director").value=d?.name||"";
    document.getElementById("writer").value=w?.name||"";
    document.getElementById("poster").value=data.poster_path?`https://image.tmdb.org/t/p/w500${data.poster_path}`:"";
    document.getElementById("backdrop").value=data.backdrop_path?`https://image.tmdb.org/t/p/original${data.backdrop_path}`:"";
    const tr=data.videos?.results?.find(v=>v.type==="Trailer");
    document.getElementById("trailer").value=tr?`https://www.youtube.com/watch?v=${tr.key}`:"";
  }catch(e){alert("Fetch error");}
}

function addDownload(){
  const div=document.createElement("div");
  div.className="download-pair";
  div.innerHTML=`<input type="text" class="form-control" placeholder="Label"><input type="text" class="form-control" placeholder="Download URL">`;
  document.getElementById("download-links").appendChild(div);
}

function generateHTML(){
  const t=(id)=>document.getElementById(id).value||"";
  let dls="";
  document.querySelectorAll("#download-links .download-pair").forEach(p=>{
    const l=p.children[0].value,u=p.children[1].value;
    if(l&&u)dls+=`<a class="btn btn-primary m-1" href="${u}" target="_blank">${l}</a>\n`;
  });
  const html=`<div class="post">
  <img src="${t('backdrop')}" style="width:100%;border-radius:15px;">
  <h2 style="color:#ffcc00;">${t('title')} <small>(${t('type')})</small></h2>
  <p><b>Tagline:</b> ${t('tagline')}</p>
  <p><b>Overview:</b> ${t('overview')}</p>
  <img src="${t('poster')}" style="width:200px;border-radius:10px;">
  <p><b>Genres:</b> ${t('genres')}</p>
  <p><b>Release:</b> ${t('release_date')} | <b>Runtime:</b> ${t('runtime')} min</p>
  <p><b>Language:</b> ${t('languages')}</p>
  <p><b>Rating:</b> ‚≠ê ${t('rating')}</p>
  <p><b>Director:</b> ${t('director')} | <b>Writer:</b> ${t('writer')}</p>
  <p><b>Cast:</b> ${t('cast')}</p>
  ${t('trailer')?`<iframe width="560" height="315" src="${t('trailer').replace('watch?v=','embed/')}" frameborder="0" allowfullscreen></iframe>`:""}
  <div class="downloads mt-3">${dls}</div>
  <p><b>Labels:</b> ${t('genres')}</p>
</div>`;
  document.getElementById("output").innerText=html;
  document.getElementById("preview").innerHTML=html;
}

function copyHTML(){navigator.clipboard.writeText(document.getElementById("output").innerText);alert("Copied!");}

function postToBlogger(){
  const title=encodeURIComponent(document.getElementById("title").value);
  const genres=encodeURIComponent(document.getElementById("genres").value);
  const body=encodeURIComponent(document.getElementById("output").innerText+"\n\nLabels: "+genres);
  const url=`https://mail.google.com/mail/?view=cm&fs=1&to=${bloggerEmail}&su=${title}&body=${body}`;
  window.open(url,"_blank");
}
</script>
</body>
</html>
